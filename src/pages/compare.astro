---
import BaseLayout from '../layouts/BaseLayout.astro';
import ComparisonEngine from '../components/interactive/ComparisonEngine.svelte';
import { getAllCasinos, getCasinosWithRelations } from '../db/queries';
import { SITE_URL } from '../config/constants';

// Fetch all casinos with their relationships (payments + software)
const casinos = getAllCasinos();
const casinoIds = casinos.map((c) => c.id);
const enrichedCasinos = getCasinosWithRelations(casinoIds);

// Schema.org - WebApplication for comparison tool
const schema = {
	'@context': 'https://schema.org',
	'@type': 'WebApplication',
	name: 'Casino Comparison Tool',
	description: 'Compare the best online casinos in Canada side-by-side. Analyze bonuses, payout speeds, and game libraries to find your perfect match.',
	url: `${SITE_URL}/compare/`,
	applicationCategory: 'UtilityApplication',
	operatingSystem: 'Web Browser',
	offers: {
		'@type': 'Offer',
		price: '0',
		priceCurrency: 'CAD',
	},
	featureList: [
		'Side-by-side casino comparison',
		'Compare bonuses and payout speeds',
		'Filter by payment methods',
		'Compare game libraries',
	],
};
---

<BaseLayout
	title='Casino Comparison Tool | Compare Bonuses & Speed'
	description='Compare the best online casinos in Canada side-by-side. Analyze bonuses, payout speeds, and game libraries to find your perfect match.'
>
	<!-- Schema.org JSON-LD -->
	<script
		type='application/ld+json'
		slot='head'
		set:html={JSON.stringify(schema)}
	/>
	<!-- Hero / Header -->
	<div class='container mx-auto px-4 pt-8 pb-12'>
		<div
			class='bg-slate-900 text-white py-16 px-6 rounded-3xl shadow-lg relative overflow-hidden text-center'
		>
			<div class='relative z-10 max-w-3xl mx-auto'>
				<h1 class='text-3xl md:text-5xl font-black mb-4'>
					Casino <span class='text-red-600'>Comparison</span> Tool
				</h1>
				<p class='text-slate-300 text-lg'>
					Not sure which casino to pick? Put them head-to-head and see who
					offers the best value for your money.
				</p>
			</div>
		</div>
	</div>

	<div class='bg-gray-50 min-h-screen'>
		<ComparisonEngine client:only='svelte' allCasinos={enrichedCasinos} />
	</div>
</BaseLayout>
