---
import BaseLayout from '../layouts/BaseLayout.astro';
import CasinoTopList from '../components/ui/CasinoTopList.astro';
import SlotsSection from '../components/ui/SlotsSection.astro';
import BankingGrid from '../components/ui/BankingGrid.astro';
import { getCollection } from 'astro:content';

// Fetch only the 3 latest reviews for a "Recent Updates" section
const allReviews = await getCollection('reviews');
const latestReviews = allReviews.slice(0, 3);

// Schema.org structured data for homepage
const organizationSchema = {
	'@context': 'https://schema.org',
	'@type': 'Organization',
	name: 'Casinos Canada',
	url: 'https://casinoscanada.online',
	logo: 'https://casinoscanada.online/favicon.svg',
	description: 'Independent reviews of online casinos for Canadian players. We test payout speeds, bonuses, and game fairness.',
	sameAs: [
		// Add social media profiles here when available
		// 'https://twitter.com/casinoscanada',
		// 'https://facebook.com/casinoscanada',
	],
	contactPoint: {
		'@type': 'ContactPoint',
		contactType: 'Customer Service',
		areaServed: 'CA',
		availableLanguage: ['English'],
	},
};

const websiteSchema = {
	'@context': 'https://schema.org',
	'@type': 'WebSite',
	name: 'Casinos Canada',
	url: 'https://casinoscanada.online',
	description: 'Top-rated online casinos for Canadian players with honest reviews and fast payout testing.',
	publisher: {
		'@type': 'Organization',
		name: 'Casinos Canada',
	},
	potentialAction: {
		'@type': 'SearchAction',
		target: {
			'@type': 'EntryPoint',
			urlTemplate: 'https://casinoscanada.online/?q={search_term_string}',
		},
		'query-input': 'required name=search_term_string',
	},
};
---

<BaseLayout
	title='Best Online Casinos in Canada (2025) | Honest Reviews'
	description='Compare the top rated online casinos in Canada. We test payout speeds, bonuses, and licensing to ensure you play safely.'
>
	<!-- Schema.org JSON-LD -->
	<script
		type='application/ld+json'
		slot='head'
		set:html={JSON.stringify(organizationSchema)}
	/>
	<script
		type='application/ld+json'
		slot='head'
		set:html={JSON.stringify(websiteSchema)}
	/>
	<section
		class='bg-slate-900 text-white py-16 md:py-24 relative overflow-hidden'
	>
		<div class='container mx-auto px-4 relative z-10 text-center'>
			<h1 class='text-4xl md:text-6xl font-black mb-6 tracking-tight'>
				Find the <span class='text-red-600'>Best</span> Online Casinos
			</h1>
			<p class='text-xl text-slate-300 max-w-2xl mx-auto mb-8'>
				We personally test payout speeds, bonus terms, and game fairness so you
				don't have to. Play with confidence at Canada's top rated sites.
			</p>
			<a
				href='#top-list'
				class='bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-10 rounded-full shadow-lg transition-transform hover:scale-105 inline-block'
			>
				See Top Picks
			</a>
		</div>
	</section>

	<div id='top-list' class='container mx-auto px-4 -mt-10 relative z-20 mb-20'>
		<CasinoTopList />
	</div>

	<SlotsSection />

	<BankingGrid />

	<section class='py-16 bg-gray-50 border-t border-gray-200'>
		<div class='container mx-auto px-4'>
			<div class='flex justify-between items-end mb-10'>
				<div>
					<h2 class='text-3xl font-bold text-gray-900'>Latest Reviews</h2>
					<p class='text-gray-600 mt-2'>Freshly tested by our team.</p>
				</div>
				<a href='/reviews/' class='text-blue-600 font-bold hover:underline'
					>View All &rarr;</a
				>
			</div>

			<div class='grid grid-cols-1 md:grid-cols-3 gap-8'>
				{
					latestReviews.map((review) => (
						<a
							href={`/reviews/${review.slug}/`}
							class='group bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-lg transition-all'
						>
							<div class='p-6'>
								<div class='flex items-center gap-2 mb-3'>
									<span class='text-xs font-bold uppercase tracking-wider text-gray-400'>
										Review
									</span>
									<span class='text-xs font-bold text-yellow-600'>
										â˜… {review.data.rating}/5
									</span>
								</div>
								<h3 class='font-bold text-xl text-gray-900 group-hover:text-blue-600 transition-colors mb-2'>
									{review.data.title.split(':')[0]}
								</h3>
								<p class='text-gray-600 text-sm line-clamp-2'>
									{review.data.metaDescription}
								</p>
							</div>
						</a>
					))
				}
			</div>
		</div>
	</section>
</BaseLayout>
