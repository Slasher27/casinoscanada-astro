---
import { getCollection } from 'astro:content';
import ReviewLayout from '../../layouts/ReviewLayout.astro';

// 1. getStaticPaths (No change needed)
export async function getStaticPaths() {
	const reviews = await getCollection('reviews');
	return reviews.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
// Extract 'headings' for TOC
const { Content, headings } = await entry.render();
---

<ReviewLayout frontmatter={entry.data} headings={headings}>
	<script
		type='application/ld+json'
		slot='head'
		set:html={JSON.stringify({
			'@context': 'https://schema.org/',
			'@type': 'Review',
			itemReviewed: {
				'@type': 'Casino',
				name: entry.data.title,
			},
			reviewRating: {
				'@type': 'Rating',
				ratingValue: entry.data.rating,
			},
			author: {
				'@type': 'Organization',
				name: entry.data.author,
			},
		})}
	/>

	<div class='prose prose-lg prose-slate max-w-none'>
		<Content />
	</div>
</ReviewLayout>
