---
const { casino, review, index } = Astro.props;

const FALLBACK_ICON =
	'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzlDQTNBRiI+PHBhdGggZD0iTTEyIDFMMyA1djZjMCA1LjU1IDMuODQgMTAuNzQgOSAxMiA1LjE2LTEuMjYgOS02LjQ1IDktMTJWNWwtOS00em0wIDEwLjk5aDdjLS41MyA0LjEyLTMuMjggNy43OS03IDguOTRWMTJINVY2LjNsNy0zLjExdjguOHoiLz48L3N2Zz4=';
---

<div
	class='bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow relative group'
>
	<!-- MOBILE / TABLET VIEW (< 1024px) -->
	<div class='lg:hidden p-5 flex flex-col gap-4'>
		<!-- Top Row: Logo, Rank, Name, Info -->
		<div class='flex items-start gap-4'>
			<!-- Rank Badge (Optional context) -->
			<div
				class='absolute top-0 left-0 bg-slate-100 text-slate-500 text-xs font-bold px-3 py-1 rounded-br-lg z-10 border-b border-r border-gray-200'
			>
				#{index + 1}
			</div>

			<div
				class='w-24 h-24 flex-shrink-0 flex items-center justify-center mt-2 overflow-hidden rounded-xl'
			>
				<img
					src={casino.logo_url || FALLBACK_ICON}
					alt={`${casino.name} Logo`}
					class='w-full h-full object-contain rounded-xl'
					onerror={`this.onerror=null; this.src='${FALLBACK_ICON}';`}
				/>
			</div>
			<div class='flex-grow pt-1'>
				<h3 class='text-xl font-black text-slate-900 leading-none mb-1'>
					<a
						href={`/reviews/${review.slug}`}
						class='hover:text-red-600 transition-colors no-underline'
					>
						{casino.name}
					</a>
				</h3>
				<div class='flex flex-wrap gap-2 text-xs font-bold text-gray-500 mb-2'>
					<span
						class='bg-green-50 text-green-700 px-2 py-0.5 rounded border border-green-100'
					>
						{review.data.rating}/5 Rating
					</span>
					<span
						class='bg-blue-50 text-blue-700 px-2 py-0.5 rounded border border-blue-100'
					>
						{casino.license || 'Licensed'}
					</span>
				</div>
				<p class='text-xs text-gray-500 line-clamp-2 leading-tight'>
					{review.data.metaDescription}
				</p>
			</div>
		</div>

		<!-- Middle: Bonus Box -->
		<div class='bg-gray-50 border border-gray-100 rounded-lg p-3 text-center'>
			<span
				class='block text-xs font-bold text-gray-400 uppercase tracking-wide mb-1'
				>Welcome Offer</span
			>
			<span class='block text-lg font-black text-slate-900'
				>{casino.bonus_offer}</span
			>
		</div>

		<!-- Bottom: Specs & CTA -->
		<div
			class='flex flex-wrap items-center justify-between gap-4 border-t border-gray-100 pt-3'
		>
			<div class='flex flex-col gap-1'>
				<span class='text-sm font-bold text-slate-800'
					>âš¡ {casino.payout_speed_minutes} mins</span
				>
			</div>
			<a
				href={`/reviews/${review.slug}`}
				class='flex-grow sm:flex-grow-0 bg-white border-2 border-slate-900 text-slate-900 hover:bg-slate-900 hover:text-white font-bold py-2 px-6 rounded-lg text-center shadow-sm active:scale-95 transition-all text-sm uppercase tracking-wide'
			>
				Read Review
			</a>
			<a
				href={casino.website_url}
				class='flex-grow sm:flex-grow-0 bg-red-600 text-white font-bold py-2 px-6 rounded-lg text-center shadow-md active:scale-95 transition-transform text-sm uppercase tracking-wide'
			>
				Play Now
			</a>
		</div>
	</div>

	<!-- DESKTOP VIEW (>= 1024px) -->
	<div class='hidden lg:grid grid-cols-12 gap-4 items-center p-4 min-h-[100px]'>
		<!-- Rank -->
		<div class='col-span-1 flex justify-center'>
			<div
				class='w-10 h-10 rounded-full bg-slate-50 text-slate-400 font-bold text-lg flex items-center justify-center border border-slate-100'
			>
				{index + 1}
			</div>
		</div>

		<!-- Info -->
		<div class='col-span-4 flex items-center gap-4'>
			<div
				class='w-24 h-24 flex-shrink-0 flex items-center justify-center overflow-hidden rounded-xl'
			>
				<img
					src={casino.logo_url || FALLBACK_ICON}
					alt={`${casino.name} Logo`}
					class='w-full h-full object-contain rounded-xl'
					onerror={`this.onerror=null; this.src='${FALLBACK_ICON}';`}
				/>
			</div>
			<div>
				<a
					href={`/reviews/${review.slug}`}
					class='font-bold text-xl text-slate-900 hover:text-red-600 transition-colors no-underline block'
				>
					{casino.name}
				</a>
				<div class='flex items-center gap-2 mt-1'>
					<span
						class='text-xs font-bold bg-yellow-400 text-black px-2 py-0.5 rounded shadow-sm'
					>
						â˜… {review.data.rating}/5
					</span>
					<span
						class='text-xs font-bold text-blue-600 flex items-center gap-1'
						title='Payout Ratio'
					>
						ðŸ“ˆ {casino.payout_ratio}% RTP
					</span>
				</div>
				<p class='text-xs text-gray-400 mt-2 line-clamp-1 max-w-[200px]'>
					{review.data.metaDescription}
				</p>
			</div>
		</div>

		<!-- Logos (Software & Banking Mixed) -->
		<div class='col-span-3 flex flex-col justify-center gap-3'>
			<div class='flex items-center gap-2 overflow-hidden'>
				<span
					class='text-[10px] uppercase font-bold text-gray-400 w-12 shrink-0'
					>Games</span
				>
				{
					casino.software
						?.slice(0, 4)
						.map((s) => (
							<img
								src={s.logo_url}
								title={s.name}
								alt={s.name}
								class='h-10 w-auto object-contain grayscale hover:grayscale-0 opacity-80 hover:opacity-100 transition-all cursor-help'
							/>
						))
				}
			</div>
			<div class='flex items-center gap-2 overflow-hidden'>
				<span
					class='text-[10px] uppercase font-bold text-gray-400 w-12 shrink-0'
					>Bank</span
				>
				{
					casino.payments
						?.slice(0, 5)
						.map((p) => (
							<img
								src={p.logo_url}
								title={p.name}
								alt={p.name}
								class='h-6 w-auto object-contain'
							/>
						))
				}
			</div>
		</div>

		<!-- Bonus -->
		<div class='col-span-2 text-center flex flex-col justify-center'>
			<span class='font-bold text-slate-900 text-lg leading-tight'
				>{casino.bonus_offer}</span
			>
			{
				(casino.bonus_spins || 0) > 0 && (
					<span class='text-xs text-red-600 font-bold bg-red-50 inline-block mx-auto px-2 py-0.5 rounded-full mt-1 border border-red-100'>
						+ {casino.bonus_spins} Free Spins
					</span>
				)
			}
		</div>

		<!-- CTA -->
		<div class='col-span-2 flex flex-col gap-2 justify-center text-center'>
			<a
				href={casino.website_url}
				class='bg-red-600 hover:bg-red-700 text-white font-bold py-2.5 px-4 rounded-lg shadow-sm hover:shadow-md transition-all hover:scale-105 text-sm uppercase tracking-wide'
			>
				Play Now
			</a>
			<a
				href={`/reviews/${review.slug}`}
				class='bg-white border-2 border-gray-200 hover:border-slate-900 text-slate-600 hover:text-slate-900 font-bold py-2.5 px-4 rounded-lg text-sm uppercase tracking-wide transition-colors'
			>
				Read Review
			</a>
		</div>
	</div>
</div>
